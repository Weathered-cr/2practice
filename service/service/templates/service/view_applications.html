{% extends "base.html" %}

{% block title %}Мои заявки{% endblock %}

{% block content %}
  <h1>Мои заявки</h1>

  <form method="get">
    <p>
      Фильтровать по статусу:
      <select name="status">
        <option value="">Все</option>
        <option value="new" {% if request.GET.status =="new" %}selected{% endif %}>Новые</option>
        <option value="in_progress" {% if request.GET.status =="in_progress" %}selected{% endif %}>В работе</option>
        <option value="completed" {% if request.GET.status =="completed" %}selected{% endif %}>Завершенные</option>
      </select>
      <button type="submit">Применить</button>
    </p>
  </form>

  {% if applications %}
    <table>
      <thead>
        <tr>
          <th>Номер</th>
          <th>Название</th>
          <th>Категория</th>
          <th>Статус</th>
          <th>Действия</th>
        </tr>
      </thead>
      <tbody>
        {% for application in applications %}
          <tr>
            <td>{{ application.id }}</td>
            <td>{{ application.title }}</td>
            <td>{{ application.category }}</td>
            <td>{{ application.get_status_display }}</td>
            <td>
              {% if application.status == "new" %}
                <a href="{% url 'delete_application' application.id %}">Удалить</a>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>У вас еще нет заявок</p>
  {% endif %}

  <p><a href="{% url 'create_application' %}">Создать новую заявку</a></p>
{% endblock %}