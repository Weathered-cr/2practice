<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Мои заявки</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'accounts/style.css' %}">
</head>
<body>
<div class="table-container">
    <h2>Мои заявки</h2>

    <form method="get">
        <label>Фильтр по статусу:</label>
        <select name="status" onchange="this.form.submit()">
            <option value="">Все</option>
            <option value="new">Новая</option>
            <option value="in_progress">Принято в работу</option>
            <option value="completed">Выполнено</option>
        </select>
    </form>

    {% if applications %}
    <table border="1" cellpadding="6">
        <tr>
            <th>Дата</th>
            <th>Название</th>
            <th>Категория</th>
            <th>Статус</th>
            <th>Действие</th>
        </tr>
        {% for app in applications %}
        <tr>
            <td>{{ app.timestamp|date:"d.m.Y H:i" }}</td>
            <td>{{ app.title }}</td>
            <td>{{ app.category }}</td>
            <td>{{ app.get_status_display }}</td>
            <td>
                {% if app.status == "new" %}
                    <a href="{% url 'delete_application' app.id %}">Удалить</a>
                {% else %}
                    -
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
    {% else %}
    <p>Заявок пока нет.</p>
    {% endif %}

    <p><a href="{% url 'create_application' %}" class="home-btn">Создать заявку</a></p>
    <p><a href="{% url 'profile' %}" class="home-btn">Профиль</a></p>
</div>
</body>
</html>
